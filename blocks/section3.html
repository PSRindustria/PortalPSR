<!-- blocks/section3.html -->

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  /* Reset e fonte apenas dentro do quote */
  #quote-section,
  #quote-section * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
  }
  /* Container principal */
  #quote-section .display {
    width: 100%;
    max-width: 800px;
    height: 50px;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    text-align: center;
    padding: 0 15px;
    border-radius: 10px;
    background: #f4f4f4;
    margin: auto;
  }
  /* Texto */
  #quote-section #daily-quote {
    display: inline-block;
    white-space: normal;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.2;
    font-size: 1.2rem;
    opacity: 1;
    transition: opacity 1s ease-in-out;
  }
  /* Animação flash inicial */
  @keyframes flashAnimation {
    0%   { filter: brightness(1) hue-rotate(0deg); }
    50%  { filter: brightness(2) hue-rotate(45deg); }
    100% { filter: brightness(1) hue-rotate(0deg); }
  }
  #quote-section .flash {
    animation: flashAnimation 1s ease-in-out 2;
  }
</style>

<div id="quote-section">
  <div class="display">
    <p id="daily-quote">Frase do dia:</p>
  </div>
</div>

<script>
(function(){
  const container = document.querySelector('#quote-section .display');
  const displayEl = document.getElementById('daily-quote');

  // flash inicial
  container.classList.add('flash');
  setTimeout(()=> container.classList.remove('flash'), 2000);

  // cores por mês
  const cores = {
    0: {bg:"#cfd0d5", text:"#000"},
    1: {bg:"#ff7709", text:"#fff"},
    2: {bg:"#fec9d9", text:"#b6063b"},
    3: {bg:"#abc8e7", text:"#20466f"},
    4: {bg:"#ff7bac", text:"#89103d"},
    5: {bg:"#588644", text:"#154003"},
    6: {bg:"linear-gradient(to right, #01a75b, #fecd2a)", text:"#574a20"},
    7: {bg:"#886aaa", text:"#513176"},
    8: {bg:"#ffce59", text:"#594d31"},
    9: {bg:"#f6c0d8", text:"#9a335d"},
    10:{bg:"#d4eff1", text:"#034d72"},
    11:{bg:"#b42619", text:"#7b0d0d"}
  };
  const now = new Date(), m = now.getMonth(), cfg = cores[m];
  if (m === 6) container.style.background = cfg.bg;
  else container.style.backgroundColor = cfg.bg;
  displayEl.style.color = cfg.text;

  // frases
  const quotes = [ /* ...coleção de frases... */ ];

  function countWeekdays(start,end){
    let c=0, d=new Date(start);
    while(d<=end){
      if(d.getDay()!==0&&d.getDay()!==6) c++;
      d.setDate(d.getDate()+1);
    }
    return c;
  }
  function resizeToFit(el,ct){
    el.style.fontSize="20px";
    let sz=parseFloat(getComputedStyle(el).fontSize);
    while(el.scrollHeight>ct.clientHeight&&sz>8){
      sz-=0.5; el.style.fontSize=sz+"px";
    }
  }
  function getDailyQuote(){
    const today=new Date(), dow=today.getDay();
    if(dow===0||dow===6) return "";
    const ref=new Date("2025-01-02T00:00:00");
    const passed=countWeekdays(ref,today);
    return quotes[(passed-1)%quotes.length];
  }

  const quoteText = getDailyQuote();
  const labelText = "Reflexão do dia:";
  const durQuote = 12000, durLabel = 2000, durTrans = 1000;

  function fadeOut(cb){
    displayEl.style.opacity = 0;
    setTimeout(cb, durTrans);
  }
  function fadeIn(txt, cb){
    displayEl.textContent = txt;
    displayEl.style.opacity = 0;
    resizeToFit(displayEl, container);
    setTimeout(()=> displayEl.style.opacity = 1, 50);
    if(cb) setTimeout(cb, durTrans);
  }
  function cycle(){
    fadeIn(quoteText, ()=>{
      setTimeout(()=> fadeOut(()=>{
        fadeIn(labelText, ()=> setTimeout(cycle, durLabel));
      }), durQuote);
    });
  }

  if(quoteText) cycle();
  else displayEl.textContent = labelText;
})();
</script>
