<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma"        content="no-cache" />
  <meta http-equiv="Expires"       content="0" />
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" href="favicon.png" type="image/png">
  <meta property="og:title" content="Portal PSR">
  <meta property="og:description" content="Acesse nosso canal interno com not√≠cias, card√°pio, aniversariantes e muito mais!">
  <meta property="og:image" content="https://i.postimg.cc/6QTrrhr6/thumbnail.jpg">
  <meta property="og:url" content="https://psrindustria.github.io/PortalPSR/">
  <meta property="og:type" content="website">
  <title>PortalPSR - Feliz Ano Novo</title>
  
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
    /* 1. TEMA DE ANO NOVO (CLEAN - SEM BORDAS) */
    :root {
      color-scheme: light;
      --bg-body: #f9f9f9; 
      --bg-card: #ffffff;
      --text-primary: #333333;
      
      /* Cores de Ano Novo */
      --primary-color: #001f3f; /* Azul Noite */
      --secondary-color: #C0C0C0; /* Prata */
      --gold-color: #D4AF37;    /* Dourado */
      --shadow: rgba(0, 0, 0, 0.1); /* Sombra neutra e suave */
      --shadow-hover: rgba(212, 175, 55, 0.3); /* Sombra dourada apenas no hover */
    }

    body {
      background-color: var(--bg-body) !important;
      color: var(--text-primary) !important;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    /* Fundo sutil */
    body::before {
        content: "";
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none;
        background-image: radial-gradient(circle, #D4AF37 0.5px, transparent 0.5px);
        background-size: 50px 50px;
        opacity: 0.1;
        z-index: -1;
    }
    
    /* 2. CONFIGURA√á√ÉO GERAL DOS CARDS (SEM BORDAS) */
    .novidade-card, 
    .aniversariante-card, 
    .ferias-card, 
    .cipa-card {
      background-color: var(--bg-card) !important;
      color: var(--text-primary) !important;
      /* Apenas sombra, sem border-top */
      box-shadow: 0 4px 15px var(--shadow) !important; 
      border-radius: 12px;
      border: none !important; /* Garante remo√ß√£o de bordas */
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .novidade-card:hover, .aniversariante-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 25px var(--shadow-hover) !important;
    }

    /* CARD REFLEX√ÉO (SEM CONTORNO) */
    .reflexao-card {
      background-color: var(--bg-card) !important;
      color: var(--text-primary) !important; 
      border: none !important; /* Removido contorno */
      border-radius: 12px;
      width: 100%; 
      padding: 30px;
      text-align: center;
      margin: 10px 0;
      position: relative;
    }
    
    /* √çcone decorativo (Estrela) */
    .reflexao-card::after {
        content: '\f005'; 
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        top: -10px;
        right: 10px;
        font-size: 1.5rem;
        color: var(--gold-color);
        opacity: 0.5;
        transform: rotate(25deg);
    }

    .reflexao-autor {
      font-size: 0.85rem;
      opacity: 0.8;
      margin-top: 10px;
      font-style: italic;
      color: var(--primary-color);
    }

    /* 3. LAYOUT DAS SE√á√ïES */
    html {
      scroll-behavior: smooth;
      height: auto; 
      overflow-y: auto;
    }

    section.banner, 
    section.section {
      height: auto;         
      min-height: auto;     
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 60px 20px; 
      box-sizing: border-box;
      scroll-margin-block-start: 20px; 
    }

    /* BANNER (SEM BORDA INFERIOR) */
    section.banner {
      min-height: 400px;
      background: 
        linear-gradient(135deg, rgba(0, 31, 63, 0.85) 0%, rgba(17, 17, 17, 0.9) 100%),
        url('https://i.postimg.cc/G3XVVmLZ/banner-v2.jpg') center/cover no-repeat;
      color: white;
      position: relative;
      overflow: hidden;
      border: none !important; /* Removido contorno */
      margin-top: 35px;
    }
    
    section.banner h1 {
        text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        font-weight: 800;
        letter-spacing: 1px;
    }

    /* Bot√£o do Banner (Sem borda) */
    .banner-btn {
        background-color: var(--gold-color);
        color: #001f3f !important;
        padding: 12px 35px;
        border-radius: 50px;
        text-decoration: none;
        font-weight: bold;
        border: none !important; /* Removido contorno */
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        transition: all 0.3s;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    .banner-btn:hover {
        background-color: #fff;
        color: var(--gold-color) !important;
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
    }

    .section-title {
      text-align: center;
      margin-bottom: 30px;
      width: 100%;
      font-size: 2rem;
      color: var(--primary-color);
      text-transform: uppercase;
      letter-spacing: 2px;
      position: relative;
      display: inline-block;
    }
    
    .section-title::before, .section-title::after {
        content: "‚ú¶";
        color: var(--gold-color);
        margin: 0 15px;
        font-size: 1.2rem;
        vertical-align: middle;
        opacity: 0.7;
    }

    /* Containers */
    .novidades-container, 
    .reflexao-container, 
    .aniversariantes-container, 
    .ferias-container, 
    .cipa-container,
    .ferias-grid {
      width: 100%;
      max-width: 1200px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin: 0 auto;
    }
    
    .novidade-img i {
        color: var(--gold-color);
        font-size: 2rem;
    }

    /* 4. BOT√ÉO REFLEX√ÉO (SEM BORDA) */
    .reflexao-instrucao {
      background-color: var(--primary-color);
      color: var(--gold-color) !important;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 8px 135px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 0.9rem;
      letter-spacing: 1px;
      border: none !important; /* Removido contorno */
      margin: 20px auto; 
      white-space: nowrap; 
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      animation: pulse-gold 2s infinite;
    }

    .reflexao-instrucao:hover {
      background-color: #003366;
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
    }

    @keyframes pulse-gold {
      0% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(212, 175, 55, 0); }
      100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); }
    }

    .ferias-table {
      margin: 20px auto;
      max-width: 1000px;
      width: 100%;
      border-collapse: collapse;
      border: none !important;
    }
    
    .ferias-table thead tr {
        background-color: var(--primary-color);
        color: var(--gold-color);
    }
    
    /* Aniversariante Destaque (SEM BORDA, APENAS GLOW) */
    .destaque-hoje {
        border: none !important; /* Removido contorno */
        box-shadow: 0 0 25px rgba(212, 175, 55, 0.6) !important;
        position: relative;
        overflow: visible !important;
        z-index: 1;
    }
    
    /* CONFETES */
    #confetti-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        overflow: hidden;
    }
    
    .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        background-color: var(--gold-color);
        opacity: 0.8;
        animation: fall linear infinite;
    }

    @keyframes fall {
        to {
            transform: translateY(105vh) rotate(720deg);
        }
    }

    /* Mobile */
    @media (max-width: 768px) {
      section.section {
        scroll-margin-top: 80px; 
        padding: 40px 15px;      
        justify-content: flex-start; 
      }
      .aniversariante-card,
      .cipa-card {
        width: 100% !important;        
        max-width: none !important;    
        flex: 1 1 100%;                
        box-sizing: border-box;
      }
      .reflexao-card {
        padding: 15px 0px !important; 
        width: 100% !important;
        margin: 0 !important;          
      }
      .reflexao-instrucao {
          padding: 8px 40px; 
      }
    }
/* CORRE√á√ÉO DE ALINHAMENTO - ANIVERSARIANTES */
    #aniversariantes-container {
      display: grid !important; /* Muda de Flex para Grid */
      /* Cria colunas autom√°ticas de no m√≠nimo 240px. 
         Isso garante 4 cards em telas grandes e alinha a √∫ltima linha √† esquerda */
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 20px;
      justify-content: center;
      width: 100%;
    }

    /* Ajuste para o card preencher a c√©lula do grid */
    #aniversariantes-container .aniversariante-card {
      width: 100% !important;
      max-width: none !important;
      margin: 0 !important; /* Remove margens extras se houver */
    }
  </style>
</head>
<body>
  <div id="confetti-container"></div>
  
  <div id="menu-placeholder"></div>

  <section class="banner" id="inicio">
    <div style="font-size: 4rem; margin-bottom: 10px; opacity: 0.9; text-shadow: 0 0 20px rgba(255,215,0,0.8);">ü•Ç</div>
    <h1>Bem-vindo ao PortalPSR</h1>
    <p>Celebrando conquistas e novos come√ßos. Feliz Ano Novo!</p>
    <a href="https://psrindustria.github.io/PortalPSR/cardapio.html" class="banner-btn">Card√°pio da Semana</a>
  </section>

  <main>
    <section id="novidades" class="section">
      <h2 class="section-title">Novidades</h2>
      <div class="novidades-header" style="justify-content: center; display: flex; width: 100%; margin-bottom: 20px; color: var(--primary-color);">
        <i class="far fa-clock"></i>&nbsp;
        <span id="data-hoje-novidades"></span>
      </div>
      <div id="novidades-container" class="novidades-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>

    <section id="reflexao-do-dia" class="section">
      <h2 class="section-title">Reflex√£o</h2>
      <div id="reflexao-container" class="reflexao-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>

    <section id="aniversariantes" class="section">
      <h2 class="section-title">Aniversariantes do M√™s</h2>
      <div id="aniversariantes-container" class="aniversariantes-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>

<section id="ferias" class="section">
      <h2 class="section-title">Colaboradores em F√©rias</h2>
      <div class="ferias-container">
        <table class="ferias-table">
          <thead>
            <tr>
              <th>Colaborador</th>
              <th>Departamento</th>
              <th>In√≠cio</th>
              <th>Retorno</th>
            </tr>
          </thead>
          <tbody id="ferias-tbody">
            <tr><td colspan="4"><div class="loading"><div class="loading-spinner"></div></div></td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <section id="cipa" class="section">
      <h2 class="section-title">CIPA</h2>
      <div id="cipa-container" class="cipa-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>
  </main>

  <div id="footer-placeholder"></div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    
    // --- 0. SCRIPT DE CONFETES ---
    function createConfetti() {
        const container = document.getElementById('confetti-container');
        if(!container) return;
        
        const colors = ['#D4AF37', '#C0C0C0', '#FFFFFF', '#DAA520'];
        const numberOfConfetti = 30; 
        
        for (let i = 0; i < numberOfConfetti; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.left = Math.random() * 100 + 'vw';
            const w = Math.random() * 8 + 5 + 'px';
            const h = Math.random() * 8 + 5 + 'px';
            confetti.style.width = w;
            confetti.style.height = h;
            const duration = Math.random() * 3 + 4 + 's';
            confetti.style.animationDuration = duration;
            confetti.style.animationDelay = Math.random() * 5 + 's';
            container.appendChild(confetti);
        }
    }
    createConfetti();

    // --- 1. INTERCEPTADOR ---
    document.addEventListener('click', (e) => {
      const link = e.target.closest('a');
      if (link) {
        const href = link.getAttribute('href');
        if (href && href.includes('#')) {
          const hashIndex = href.lastIndexOf('#');
          const targetId = href.substring(hashIndex + 1);
          const targetSection = document.getElementById(targetId);

          if (targetSection) {
            e.preventDefault(); 
            const menuEl = document.getElementById('menu');
            if (menuEl) menuEl.classList.remove('active');
            const isMobile = window.innerWidth < 768;
            targetSection.scrollIntoView({
              behavior: 'smooth',
              block: isMobile ? 'start' : 'center' 
            });
          }
        }
      }
    });

    // --- 2. SCRIPT DE FOGOS ---
    function spawnFirework(container) {
      if (!container) return;
      const rect = container.getBoundingClientRect();
      const centerX = Math.random() * rect.width;
      const centerY = Math.random() * rect.height;

      const colors = ['#D4AF37', '#C0C0C0', '#FFFFFF', '#001f3f', '#FFD700'];
      const particleCount = 40; 

      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        const size = Math.random() * 4 + 2; 

        Object.assign(particle.style, {
          position: 'absolute',
          width: `${size}px`,
          height: `${size}px`,
          backgroundColor: colors[Math.floor(Math.random() * colors.length)],
          borderRadius: '50%',
          left: `${centerX}px`,
          top: `${centerY}px`,
          opacity: '1',
          pointerEvents: 'none',
          boxShadow: `0 0 ${size * 2}px ${colors[Math.floor(Math.random() * colors.length)]}`,
          transform: 'translate(-50%, -50%) scale(1)',
          zIndex: '10'
        });

        container.appendChild(particle);

        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 5 + 2;
        
        let vx = Math.cos(angle) * speed;
        let vy = Math.sin(angle) * speed;
        const friction = 0.94;
        const gravity = 0.15;

        (function animate() {
          vx *= friction;
          vy *= friction;
          vy += gravity;

          const currentLeft = parseFloat(particle.style.left);
          const currentTop = parseFloat(particle.style.top);

          particle.style.left = `${currentLeft + vx}px`;
          particle.style.top  = `${currentTop + vy}px`;

          particle.style.opacity = parseFloat(particle.style.opacity) - (0.01 + Math.random() * 0.015);
          const currentScale = parseFloat(particle.style.transform.replace(/[^0-9.]/g, '')) || 1;
          particle.style.transform = `translate(-50%, -50%) scale(${currentScale * 0.96})`;

          if (particle.style.opacity > 0) {
            requestAnimationFrame(animate);
          } else {
            particle.remove();
          }
        })();
      }
    }

    let fireworkIntervals = [];

    function clearAllFireworkIntervals() {
      fireworkIntervals.forEach(clearInterval);
      fireworkIntervals = [];
    }

    function startFireworkForElement(element) {
      if (!document.hidden) {
        const intervalId = setInterval(() => {
          if (!document.hidden && element.closest('.destaque-hoje')) {
            spawnFirework(element);
          }
        }, 800 + Math.random() * 500); 
        fireworkIntervals.push(intervalId);
      }
    }

    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        clearAllFireworkIntervals();
      } else {
        document.querySelectorAll('.destaque-hoje .twinkle-lights').forEach(tw => {
          startFireworkForElement(tw);
        });
      }
    });

    // --- 3. MENU/FOOTER ---
    ['menu','footer'].forEach(file => {
      fetch(`${file}.html?t=${Date.now()}`)
        .then(r => r.text())
        .then(html => {
          const placeholder = document.getElementById(`${file}-placeholder`);
          if (placeholder) placeholder.innerHTML = html;
          if (file === 'menu') {
            const toggle = document.getElementById('menu-toggle');
            const menuEl = document.getElementById('menu');
            if (toggle && menuEl) {
              toggle.addEventListener('click', () => {
                menuEl.classList.toggle('active');
              });
            }
          }
        }).catch(e => console.error(`Error loading ${file}.html:`, e));
    });

    // --- 4. DATA ---
    const hoje = new Date();
    const dia = hoje.getDate();
    const mes = hoje.getMonth();
    const ano = hoje.getFullYear();
    const meses = ['janeiro','fevereiro','mar√ßo','abril','maio','junho','julho','agosto','setembro','outubro','novembro','dezembro'];
    const hojePt = `${dia} de ${meses[mes]} de ${ano}`;
    const dataHojeEl = document.getElementById('data-hoje-novidades');
    if (dataHojeEl) dataHojeEl.textContent = hojePt;

    // --- 5. FETCH GEN√âRICO ---
    async function fetchData(path) {
      const cacheBuster = Date.now();
      try {
        const res = await fetch(`${path}?t=${cacheBuster}`);
        if (!res.ok) throw new Error(`HTTP error ${res.status} for ${path}`);
        return await res.json();
      } catch(e) {
        console.error(`Failed to fetch ${path}:`, e);
        return null;
      }
    }
    
    // --- 6. RENDERIZADORES ---
    
    // Novidades
    async function renderNovidades() {
      const data = await fetchData('novidades.json');
      const c = document.getElementById('novidades-container');
      if (!c) return;
      if (!data) {
        c.innerHTML = '<p>Erro ao carregar novidades.</p>';
        return;
      }
      c.innerHTML = '';
      data.forEach(n => {
        c.innerHTML += `
          <div class="novidade-card">
            <div class="novidade-img"><i class="${n.icone}"></i></div>
            <div class="novidade-content">
              <h3>${n.titulo}</h3>
              <div class="novidade-date"><i class="far fa-calendar-alt"></i> ${n.data}</div>
              <p>${n.conteudo||n.resumo||''}</p>
            </div>
          </div>`;
      });
    }

    // Reflex√£o
    async function renderReflexao() {
      const data = await fetchData('reflexaododia.json');
      const c = document.getElementById('reflexao-container');
      if (!c) return;
      if (!data) {
        c.innerHTML = '<p>Erro ao carregar reflex√£o.</p>';
        return;
      }
      const key = `${String(dia).padStart(2,'0')}/${String(mes+1).padStart(2,'0')}/${ano}`;
      const r = data.find(x => x.data === key);
      c.innerHTML = '';
      if (!r) {
        c.innerHTML = '<p>Sem reflex√£o para hoje.</p>';
        return;
      }
      const card = document.createElement('div');
      card.className = 'reflexao-card';
      
      card.innerHTML = `
        <p class="reflexao-frase">"${r.frase}"</p>
        <p class="reflexao-autor">- ${r.autor}</p>
        <button class="reflexao-instrucao">Clique aqui para refletir</button>
        <div class="reflexao-extra">
          <p class="reflexao-texto">${r.reflexao}</p>
          <p class="reflexao-data">Reflex√£o: ${r.data}</p>
        </div>`;
        
      const extra = card.querySelector('.reflexao-extra');
      const instr = card.querySelector('.reflexao-instrucao');
      
      if (extra) extra.style.display = 'none';
      if (instr) {
        instr.addEventListener('click', () => {
          if (extra) extra.style.display = extra.style.display === 'none' ? 'block' : 'none';
        });
      }
      c.appendChild(card);
    }

    // Aniversariantes
    async function renderAniversariantes() {
      const data = await fetchData('aniversariantes.json');
      const container = document.getElementById('aniversariantes-container');
      if (!container) return;
      if (!data) {
        container.innerHTML = '<p>Erro ao carregar aniversariantes.</p>';
        return;
      }
      container.innerHTML = '';
      clearAllFireworkIntervals();

      const hojeAtual = new Date();
      const diaHoje = String(hojeAtual.getDate()).padStart(2,'0');
      const mesHoje = String(hojeAtual.getMonth()+1).padStart(2,'0');
      const nomesMes = ['janeiro','fevereiro','mar√ßo','abril','maio','junho','julho','agosto','setembro','outubro','novembro','dezembro'];

      data.forEach(a => {
        const [dStr,mStr] = a.data ? a.data.split('/') : ['',''];
        const card = document.createElement('div');
        card.className = 'aniversariante-card';

        if (dStr === diaHoje && mStr === mesHoje) {
          card.classList.add('destaque-hoje');
          const tw = document.createElement('div');
          tw.className = 'twinkle-lights';
          card.appendChild(tw);
          startFireworkForElement(tw);
        }

        const dataFmt = (dStr && mStr && nomesMes[Number(mStr)-1]) ? `${dStr} de ${nomesMes[Number(mStr)-1]}` : 'Data inv√°lida';
        
        const imgContainer = document.createElement('div');
        imgContainer.className = 'aniversariante-img';
        
        if (a.imagem) {
          const img = document.createElement('img');
          img.alt = a.nome || 'Aniversariante';
          img.onerror = function() {
            if (a.imagem_fallback) {
              this.onerror = function() { imgContainer.innerHTML = '<i class="fas fa-birthday-cake"></i>'; };
              this.src = a.imagem_fallback;
            } else {
              imgContainer.innerHTML = '<i class="fas fa-birthday-cake"></i>';
            }
          };
          img.src = a.imagem;
          imgContainer.appendChild(img);
        } else {
          imgContainer.innerHTML = '<i class="fas fa-birthday-cake"></i>';
        }
        card.appendChild(imgContainer);
        
        const infoDiv = document.createElement('div');
        infoDiv.className = 'aniversariante-info';
        infoDiv.innerHTML = `
          <h3><i class="fas fa-birthday-cake"></i> ${a.nome || 'Aniversariante'}</h3>
          ${a.cargo ? `<p>${a.cargo}</p>` : ''}
          <p class="aniversariante-data">${dataFmt}</p>
        `;
        card.appendChild(infoDiv);
        container.appendChild(card);
      });
    }

// F√©rias (Vers√£o Somente Tabela)
    async function renderFerias() {
       const data = await fetchData("ferias.json");
       // Removida a refer√™ncia ao grid
       const tb = document.getElementById("ferias-tbody");
       
       if (!tb) return;

       const hoje = new Date();
       hoje.setHours(0, 0, 0, 0);

       function isSameDate(dateStr, comparisonDate) {
         try {
           const [dia, mes, ano] = dateStr.split("/");
           if (!dia || !mes || !ano || isNaN(Number(dia)) || isNaN(Number(mes)) || isNaN(Number(ano))) return false;
           const dataObj = new Date(Number(ano), Number(mes) - 1, Number(dia));
           dataObj.setHours(0, 0, 0, 0);
           return dataObj.getTime() === comparisonDate.getTime();
         } catch (e) {
           return false;
         }
       }

       const dataFiltrada = (data || []).filter(f => {
          try {
             const [dia, mes, ano] = f.retorno.split("/");
             if (!dia || !mes || !ano || isNaN(Number(dia)) || isNaN(Number(mes)) || isNaN(Number(ano))) return false;
             const dataRetorno = new Date(Number(ano), Number(mes) - 1, Number(dia));
             dataRetorno.setHours(0, 0, 0, 0);
             return dataRetorno >= hoje;
          } catch (e) { return false; }
       });

       tb.innerHTML = "";

       if (data === null) {
         const errorMsg = "<p>Erro ao carregar f√©rias.</p>";
         // Removido erro do grid
         tb.innerHTML = `<tr><td colspan="4">${errorMsg}</td></tr>`;
         return;
       }

       if (dataFiltrada.length === 0) {
         // Removida mensagem do grid
         tb.innerHTML = `<tr><td colspan="4">Nenhum colaborador em f√©rias retornando hoje ou futuramente.</td></tr>`;
         return;
       }

       dataFiltrada.forEach(f => {
         const retornaHoje = isSameDate(f.retorno, hoje);
         
         // L√ìGICA DE CRIA√á√ÉO DOS CARDS FOI REMOVIDA DAQUI

         // Mant√©m apenas a l√≥gica da tabela
         const tr = document.createElement("tr");
         if (retornaHoje) tr.classList.add("retorno-hoje-piscar");
         tr.innerHTML = `
           <td>${f.colaborador}</td>
           <td>${f.departamento}</td>
           <td>${f.inicio}</td>
           <td>${f.retorno}</td>`;
         tb.appendChild(tr);
       });
     }

    // CIPA
    async function renderCIPA() {
      const raw = await fetchData('cipa.json');
      const c = document.getElementById('cipa-container');
      if (!c) return;
      if (!raw) {
        c.innerHTML = '<p>Erro ao carregar CIPA.</p>';
        return;
      }
      c.innerHTML = '';
      const list = Array.isArray(raw) ? raw : (typeof raw === 'object' && raw !== null ? Object.values(raw) : []);
      if (list.length === 0) {
        c.innerHTML = '<p>Nenhuma informa√ß√£o da CIPA dispon√≠vel.</p>';
        return;
      }
      list.forEach(i => {
        c.innerHTML += `
          <div class="cipa-card">
            <div class="cipa-icon"><i class="${i.icone || 'fas fa-shield-alt'}"></i></div>
            <h3>${i.titulo||i.nome||'Item CIPA'}</h3>
            <p>${i.conteudo||i.cargo_cipa||''}</p>
          </div>`;
      });
    }

    renderNovidades();
    renderReflexao();
    renderAniversariantes();
    renderFerias();
    renderCIPA();
  });
  </script>

  <script>
const nomesFemininos = [
    'abigail', 'abriele', 'adriane', 'agnes', 'aitana', 'alana', 'alba', 'alessia',  
    'alexia', 'aliceia', 'alzira', 'amalia', 'ana paula', 'anais', 'angelica', 'angelina',  
    'antonia', 'anita', 'antonieta', 'ara', 'ariana', 'ariane', 'arlete', 'arlene',  
    'arminda', 'audrey', 'aurora', 'ayla', 'azilda', 'barbara', 'beatrice', 'bellamy',  
    'benedita', 'bernadete', 'bertina', 'bertha', 'betsy', 'biana', 'blendina', 'blenda',  
    'branda', 'brigitte', 'camille', 'candida', 'carmela', 'carminha', 'caroline', 'catarina',  
    'cec√≠lia', 'celia', 'celina', 'chantal', 'charlene', 'charlotte', 'christiane', 'cielete',  
    'cilene', 'clarice', 'claudete', 'claudiana', 'claudine', 'claudionora', 'clelia', 'cleusa',  
    'clotilde', 'clementina', 'cordelia', 'corina', 'cristal', 'cristela', 'crislaine', 'dad√°',  
    'dagmar', 'dalila', 'dalva', 'damiana', 'danila', 'danisa', 'darc√≠lia', 'darlene',  
    'deadina', 'deise', 'dela', 'delia', 'demetria', 'denise', 'derci', 'desir√©e',  
    'diana', 'dilma', 'dinorah', 'dion√≠sia', 'dirce', 'divina', 'dominica', 'domingas',  
    'doroteia', 'edi', 'edilene', 'edite', 'elaine', 'elba', 'elderina', 'eleonora',  
    'elfrida', 'elisabete', 'elis√¢ngela', 'eliza', 'elizabete', 'elma', 'elvira', 'ema',  
    'em√≠lia', 'ena', 'enede', 'ereia', 'erika', 'erise', 'erteca', 'erta',  
    'esmeralda', 'estela', 'estrela', 'eudoxia', 'eul√°lia', 'eunice', 'eva', 'evangelina',  
    'everl√∫cia', 'exilda', 'fabiana', 'f√°tima', 'felicidade', 'fermina', 'fiama', 'flora',  
    'florinda', 'fortuna', 'francine', 'francisca', 'frida', 'gabrielle', 'gasparina', 'genevi√®ve',  
    'genilda', 'geovana', 'geovana', 'geovana', 'gilda', 'gina', 'ginger', 'gislaine',  
    'gleice', 'glenda', 'gl√≥ria', 'goretti', 'graciete', 'gracilene', 'guida', 'haid√©e',  
    'halina', 'hanae', 'hana', 'hanna', 'helle', 'helma', 'henriqueta', 'herminia',  
    'heveline', 'hilaria', 'hilda', 'hom√©rica', 'hylda', 'ida', 'ileana', 'ilma',  
    'ilza', 'imelda', 'in√™s', 'iraci', 'irene', 'irislene', 'irlanda', 'ismaela',  
    'itagl√™cia', 'ivanete', 'ivone', 'ivoneide', 'ivonilde', 'izabel', 'izabela', 'izildinha',  
    'jada', 'janete', 'janina', 'janine', 'jaqueline', 'jelena', 'jemima', 'jessiane',  
    'joana d‚Äôarc', 'jocasta', 'joelia', 'joenilda', 'jole', 'jonas', 'jorgeana', 'joselina',  
    'josiana', 'jovita', 'joyce', 'julia', 'junia', 'justina', 'karine', 'karla',  
    'karol', 'katia', 'k√°tia', 'kely', 'keyla', 'kimberly', 'kissia', 'kristina',  
    'laraine', 'larissa', 'lau', 'lauraine', 'lea', 'lebina', 'leila', 'leina',  
    'lemara', 'lendite', 'leonor', 'lepida', 'lesbia', 'let√≠cia', 'levina', 'liana',  
    'lidia', 'lidiane', 'liliane', 'lilisa', 'lilja', 'linda', 'linet', 'lion√™',  
    'liora', 'lisandra', 'lissa', 'lita', 'lizabeth', 'lorena', 'lorene', 'lority',  
    'lourdes', 'lucia', 'lucinda', 'ludmila', 'luene', 'luise', 'luiza', 'lumena',  
    'luzia', 'lygia', 'lys', 'madalena', 'mafalda', 'maisa', 'malu', 'mamede', 'mane', 'mara', 'marcia', 'marcelina',  
    'marcelly', 'marcia', 'margarete', 'mariana', 'marieta', 'marilene', 'marilia',  
    'marilsa', 'marilu', 'marina', 'marinete', 'maristela', 'mariza', 'marli', 'marlice',  
    'marlene', 'martina', 'maruza', 'mary', 'matilde', 'maura', 'maurine', 'maury',  
    'mayara', 'mayssa', 'meire', 'melina', 'melita', 'mell', 'melody', 'michele',  
    'michelle', 'milena', 'milka', 'miltonia', 'mirela', 'mirella', 'mirian', 'mirna',  
    'mirtes', 'mirthes', 'm√¥nica', 'monse', 'muriel', 'n√°dia', 'naia', 'na√≠sa',  
    'nailda', 'n√°lia', 'nanda', 'neia', 'neide', 'neli', 'nelma', 'n√©lida',  
    'neri', 'nessa', 'neta', 'nette', 'nika', 'nilda', 'nilma', 'nilsa',  
    'ninfa', 'nisa', 'nutella', 'oaleska', 'olanda', 'olinda', 'omira', 'ontina',  
    'ophelia', 'ot√≠lia', 'oterleia', 'ourienes', 'paine', 'paix√£o', 'paloma', 'p√¢mela',  
    'patience', 'paulaine', 'paulina', 'paz', 'p√©n√©lope', 'petra', 'pi√ßas', 'pina',  
    'pira', 'piedade', 'polina', 'priscilla', 'queli', 'queila', 'quezia', 'quina',  
    'raissa', 'ralphina', 'ramira', 'rania', 'raphaela', 'rayssa', 'rebecca', 'regiane',  
    'regina', 'rejanira', 'remila', 'renata', 'renata', 'renilda', 'renilda', 'renita',  
    'renata', 'renilda', 'renata', 'renilia', 'reny', 'reparatriz', 'resia', 'rete',  
    'ricasol', 'ricasol', 'r√≠gia', 'rita de c√°ssia', 'roberta', 'rosangela', 'rosaria', 'roselane',  
    'rosilda', 'rosineide', 'rosita', 'ruby', 'rute', 'sabrina', 'sagraja', 'salete',  
    'samara', 'samira', 'samandra', 'sandra', 'sandy', 'sania', 'sanira', 'sanita', 'saraly',  
    'sara', 'savina', 'seice', 'selia', 'selva', 'senda', 'serafina', 'serena',  
    'sheron', 'shirley', 'sidneia', 's√≠lvia', 'simara', 'simona', 'sintia', 'siomara',  
    'sirlene', 's√¥nia', 'sonia', 'soraia', 'soraya', 'sueli', 's√∫ellen', 'suely',  
    'susana', 'susanne', 'sweetie', 'talitha', 'tamara', 't√¢mara', 'tamilia', 'tanice',  
    'tarcila', 'tatiane', 'tchabi', 'tecla', 'teodora', 'teresinha', 'theresa', 'th√≠cia',  
    'thiffany', 'thina', 'thomazina', 'tim√≥teo', 'tina', 'tresa', 'troiana', 't√∫lia',  
    'ulrica', 'unice', 'ur√¢nia', 'vanessa', 'v√¢nia', 'vania', 'vanda', 'vang√©lia',  
    'vanice', 'vanusa', 'vanuza', 'v√¢nia', 'venice', 'venucia', 'verena', 'ver√¥nica',  
    'viana', 'victoria', 'vict√≥ria', 'violeta', 'virginia', 'vislane', 'viviane', 'viviana',  
    'wanda', 'welma', 'luciene', 'anielle', 'yasmin', 'yana', 'yara', 'yasmin',  
    'yone', 'yvana', 'yvone', 'yvone', 'za√≠ra', 'zanira', 'zelia', 'zelia',  
    'zelma', 'z√©lia', 'ziralda', 'zirene', 'iasmim', 'daniele', 'solanie Paz', 'tayane', 'solanie', 'milene', 'zoe'
];

function removeAcentos(str) {
  return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
}

function determinarGenero(nome) {
  if (!nome) return 'masculino';
  let primeiroNome = nome.split(" ")[0].toLowerCase();
  primeiroNome = removeAcentos(primeiroNome);
  if (primeiroNome.endsWith('a') && primeiroNome !== 'joshua' && primeiroNome !== 'luca') {
    return 'feminino';
  }
  if (nomesFemininos.includes(primeiroNome)) {
    return 'feminino';
  }
  return 'masculino';
}

async function carregaJSON(arquivo) {
  try {
    return await fetch(arquivo + '?t=' + Date.now()).then(r => r.json());
  } catch (e) {
    return null;
  }
}

function juntarNomes(nomes) {
  if (nomes.length === 1) return nomes[0];
  if (nomes.length === 2) return nomes[0] + ' e ' + nomes[1];
  return nomes.slice(0, -1).join(', ') + ' e ' + nomes[nomes.length - 1];
}

function getPluralGenero(generos) {
  const femininoCount = generos.filter(g => g === "feminino").length;
  if (femininoCount === generos.length) return {pronome: "elas", verboVoltar: "voltam", verboAniv: "fazem"};
  if (femininoCount === 0) return {pronome: "eles", verboVoltar: "voltam", verboAniv: "fazem"};
  return {pronome: "eles", verboVoltar: "voltam", verboAniv: "fazem"};
}

document.addEventListener('DOMContentLoaded', async () => {
  const hoje = new Date();
  const dia = String(hoje.getDate()).padStart(2, '0');
  const mes = String(hoje.getMonth() + 1).padStart(2, '0');
  const ano = hoje.getFullYear();
  const dataAtualStr = `${dia}/${mes}`;
  const dataCompleta = `${dia}/${mes}/${ano}`;
  let mensagens = [];

  function getArtigoSingular(genero) {
    return genero === 'feminino' ? 'da' : 'do';
  }

  function getArtigoPlural(generos) {
    const todasFeminino = generos.every(g => g === 'feminino');
    return todasFeminino ? 'da' : 'das';
  }

  const aniversariantes = await carregaJSON('aniversariantes.json');
  const nomesAniv = [];
  const generosAniv = [];

  if (Array.isArray(aniversariantes)) {
    aniversariantes.forEach(({ nome, data }) => {
      if (data === dataAtualStr) {
        nomesAniv.push(nome);
        generosAniv.push(determinarGenero(nome));
      }
    });

    if (nomesAniv.length === 1) {
      const genero = generosAniv[0];
      const pronome = genero === 'feminino' ? 'ela' : 'ele';
      const artigo = getArtigoSingular(genero);
      mensagens.push(
        `ü•≥ Hoje √© anivers√°rio ${artigo} ${nomesAniv[0]}, d√™ os parab√©ns para ${pronome}!`
      );
    }
    else if (nomesAniv.length > 1) {
      const nomesStr = juntarNomes(nomesAniv);
      const pronome = generosAniv.every(g => g === 'feminino')
        ? 'elas'
        : 'eles';
      mensagens.push(
        `ü•≥ Hoje, ${nomesStr} fazem anivers√°rio. D√™ os parab√©ns a ${pronome}!`
      );
    }
  }

  const ferias = await carregaJSON('ferias.json');
  let nomesFerias = [];
  let generosFerias = [];
  if (ferias && Array.isArray(ferias)) {
    ferias.forEach(f => {
      if (f.retorno === dataCompleta) {
        nomesFerias.push(f.colaborador);
        generosFerias.push(determinarGenero(f.colaborador));
      }
    });
    if (nomesFerias.length === 1) {
      const pronome = generosFerias[0] === "feminino" ? "ela" : "ele";
      mensagens.push(`‚úàÔ∏è Hoje, ${nomesFerias[0]} retorna de f√©rias. D√™ as boas-vindas a ${pronome}!`);
    } else if (nomesFerias.length > 1) {
      const nomesStr = juntarNomes(nomesFerias);
      const plural = getPluralGenero(generosFerias);
      mensagens.push(`‚úàÔ∏è Hoje, ${nomesStr} retornam de f√©rias. D√™ as boas-vindas a ${plural.pronome}!`);
    }
  }

  const feriados = await carregaJSON('feriados.json');
  if (feriados && Array.isArray(feriados)) {
    feriados.forEach(f => {
      if (f.data === dataAtualStr) {
        mensagens.push(`üìÖ Hoje √© ${f.nome}. Bom feriado!`);
      }
    });
  }

  let mensagemFinal = mensagens.length ? mensagens.join("<br>") : "Aqui √© o seu espa√ßo. Feliz Ano Novo!";
  const bannerP = document.querySelector('.banner > p');
  if (bannerP) bannerP.innerHTML = mensagemFinal;
});
  </script>
</body>
</html>




