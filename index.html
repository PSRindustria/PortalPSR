<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma"        content="no-cache" />
  <meta http-equiv="Expires"       content="0" />
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" href="favicon.png" type="image/png">
  <meta property="og:title" content="Portal PSR">
  <meta property="og:description" content="Acesse nosso canal interno com not√≠cias, card√°pio, aniversariantes e muito mais!">
  <meta property="og:image" content="https://i.postimg.cc/6QTrrhr6/thumbnail.jpg">
  <meta property="og:url" content="https://psrindustria.github.io/PortalPSR/">
  <meta property="og:type" content="website">
  <title>PortalPSR</title>
  
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
    /* 1. TEMA CLARO */
    :root {
      color-scheme: light;
      --bg-body: #f4f4f9;
      --bg-card: #ffffff;
      --text-primary: #333333;
      --shadow: rgba(0,0,0,0.15);
      --primary-color: #0056b3; 
    }
    body {
      background-color: var(--bg-body) !important;
      color: var(--text-primary) !important;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    
    /* 2. CONFIGURA√á√ÉO GERAL DOS CARDS */
    .novidade-card, 
    .aniversariante-card, 
    .ferias-card, 
    .cipa-card {
      background-color: var(--bg-card) !important;
      color: var(--text-primary) !important;
      box-shadow: 0 4px 12px var(--shadow) !important;
      border-radius: 8px;
    }

    /* CARD REFLEX√ÉO (Padr√£o Desktop) */
    .reflexao-card {
      background-color: var(--bg-card) !important;
      color: var(--text-primary) !important;
      box-shadow: none !important; 
      border: none !important;
      border-radius: 8px;
      width: 100%; 
      padding: 30px;
      text-align: center;
      margin: 10px 0;
    }

    /* 3. LAYOUT DAS SE√á√ïES */
    html {
      scroll-behavior: smooth;
      height: auto; 
      overflow-y: auto;
    }

    section.banner, 
    section.section {
      height: auto;         
      min-height: auto;     
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 60px 20px; 
      box-sizing: border-box;
      scroll-margin-block-start: 20px; /* Margem padr√£o para scroll */
    }

    section.banner {
      min-height: 400px;
    }

    .section-title {
      text-align: center;
      margin-bottom: 30px;
      width: 100%;
      font-size: 2rem;
    }

    /* Containers */
    .novidades-container, 
    .reflexao-container, 
    .aniversariantes-container, 
    .ferias-container, 
    .cipa-container,
    .ferias-grid {
      width: 100%;
      max-width: 1200px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin: 0 auto;
    }

    /* 4. BOT√ÉO REFLEX√ÉO */
    .reflexao-instrucao {
      background-color: var(--primary-color);
      color: white !important;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12px 30px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 0.9rem;
      letter-spacing: 1px;
      border: none;
      margin: 20px auto; 
      white-space: nowrap; 
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 86, 179, 0.3);
      animation: pulse-btn 2s infinite;
    }

    .reflexao-instrucao:hover {
      background-color: #004494;
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 6px 20px rgba(0, 86, 179, 0.5);
    }

    .reflexao-instrucao:active {
      transform: translateY(1px);
    }

    @keyframes pulse-btn {
      0% { box-shadow: 0 0 0 0 rgba(0, 86, 179, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(0, 86, 179, 0); }
      100% { box-shadow: 0 0 0 0 rgba(0, 86, 179, 0); }
    }

    .ferias-table {
      margin: 20px auto;
      max-width: 1000px;
      width: 100%;
    }

    /* =========================================
       AJUSTES ESPEC√çFICOS PARA MOBILE (Android/iOS)
       ========================================= */
    @media (max-width: 768px) {
      
      /* Ajuste de scroll para mobile (alinhar topo) */
      section.section {
        scroll-margin-top: 80px; /* Compensa cabe√ßalho fixo se houver, ou d√° respiro */
        padding: 40px 15px;      /* Reduz padding lateral para ganhar espa√ßo */
        justify-content: flex-start; /* Alinha conte√∫do ao topo naturalmente */
      }

      /* Padroniza√ß√£o de Largura: Aniversariantes e CIPA iguais */
      .aniversariante-card,
      .cipa-card {
        width: 100% !important;        /* For√ßa ocupar largura total do container */
        max-width: none !important;    /* Remove limites de largura */
        flex: 1 1 100%;                /* Garante comportamento flex√≠vel total */
        box-sizing: border-box;
      }

      /* Melhoria de Legibilidade da Reflex√£o Estoica */
      .reflexao-card {
        padding: 20px 10px !important; /* Reduz padding interno para dar mais espa√ßo ao texto */
        width: 100% !important;
        margin: 0 !important;          /* Remove margens externas que apertam o card */
      }
      
      .reflexao-frase {
        font-size: 1.1rem;      /* Ajusta tamanho da fonte se necess√°rio */
        line-height: 1.6;       /* Melhora altura da linha para leitura */
        padding: 0 5px;         /* Pequeno respiro lateral */
      }
      
      .reflexao-texto {
        text-align: justify;    /* Opcional: justifica texto longo para ficar blocadinho */
        padding: 0 5px;
      }
    }
  </style>
</head>
<body>
  <div id="menu-placeholder"></div>

  <section class="banner" id="inicio">
    <h1>Bem-vindo ao PortalPSR</h1>
    <p>Aqui √© o seu espa√ßo. Aqui √© PSR!</p>
    <a href="https://psrindustria.github.io/PortalPSR/cardapio.html" class="banner-btn">Card√°pio da Semana</a>
  </section>

  <main>
    <section id="novidades" class="section">
      <h2 class="section-title">Novidades</h2>
      <div class="novidades-header" style="justify-content: center; display: flex; width: 100%; margin-bottom: 20px;">
        <i class="far fa-clock"></i>&nbsp;
        <span id="data-hoje-novidades"></span>
      </div>
      <div id="novidades-container" class="novidades-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>

    <section id="reflexao-do-dia" class="section">
      <h2 class="section-title">Reflex√£o Estoica</h2>
      <div id="reflexao-container" class="reflexao-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>

    <section id="aniversariantes" class="section">
      <h2 class="section-title">Aniversariantes do M√™s</h2>
      <div id="aniversariantes-container" class="aniversariantes-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>

    <section id="ferias" class="section">
      <h2 class="section-title">Colaboradores em F√©rias</h2>
      <div class="ferias-container">
        <div id="ferias-grid-container" class="ferias-grid">
          <div class="loading"><div class="loading-spinner"></div></div>
        </div>
        <table class="ferias-table">
          <thead>
            <tr>
              <th>Colaborador</th>
              <th>Departamento</th>
              <th>In√≠cio</th>
              <th>Retorno</th>
            </tr>
          </thead>
          <tbody id="ferias-tbody">
            <tr><td colspan="4"><div class="loading"><div class="loading-spinner"></div></div></td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <section id="cipa" class="section">
      <h2 class="section-title">CIPA</h2>
      <div id="cipa-container" class="cipa-container">
        <div class="loading"><div class="loading-spinner"></div></div>
      </div>
    </section>
  </main>

  <div id="footer-placeholder"></div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    
    // --- 1. INTERCEPTADOR DE NAVEGA√á√ÉO INTELIGENTE (MOBILE vs DESKTOP) ---
    document.addEventListener('click', (e) => {
      const link = e.target.closest('a');
      if (link) {
        const href = link.getAttribute('href');
        if (href && href.includes('#')) {
          const hashIndex = href.lastIndexOf('#');
          const targetId = href.substring(hashIndex + 1);
          const targetSection = document.getElementById(targetId);

          if (targetSection) {
            e.preventDefault(); 
            
            const menuEl = document.getElementById('menu');
            if (menuEl) menuEl.classList.remove('active');

            // DETECTA SE √â MOBILE (largura < 768px)
            const isMobile = window.innerWidth < 768;

            // Se Mobile -> Alinha no TOPO ('start')
            // Se Desktop -> Alinha no CENTRO ('center')
            targetSection.scrollIntoView({
              behavior: 'smooth',
              block: isMobile ? 'start' : 'center' 
            });
          }
        }
      }
    });

    // --- 2. SCRIPT DE FOGOS ---
    function spawnFirework(container) {
      if (!container) return;
      const rect = container.getBoundingClientRect();
      const centerX = Math.random() * rect.width;
      const centerY = Math.random() * rect.height;

      const colors = ['#FFD700', '#FF4500', '#32CD32', '#1E90FF', '#FF1493', '#FFFFFF', '#FFFF00'];
      const particleCount = 40; 

      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        const size = Math.random() * 4 + 2; 

        Object.assign(particle.style, {
          position: 'absolute',
          width: `${size}px`,
          height: `${size}px`,
          backgroundColor: colors[Math.floor(Math.random() * colors.length)],
          borderRadius: '50%',
          left: `${centerX}px`,
          top: `${centerY}px`,
          opacity: '1',
          pointerEvents: 'none',
          boxShadow: `0 0 ${size * 2}px ${colors[Math.floor(Math.random() * colors.length)]}`,
          transform: 'translate(-50%, -50%) scale(1)',
          zIndex: '10'
        });

        container.appendChild(particle);

        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 5 + 2;
        
        let vx = Math.cos(angle) * speed;
        let vy = Math.sin(angle) * speed;
        const friction = 0.94;
        const gravity = 0.15;

        (function animate() {
          vx *= friction;
          vy *= friction;
          vy += gravity;

          const currentLeft = parseFloat(particle.style.left);
          const currentTop = parseFloat(particle.style.top);

          particle.style.left = `${currentLeft + vx}px`;
          particle.style.top  = `${currentTop + vy}px`;

          particle.style.opacity = parseFloat(particle.style.opacity) - (0.01 + Math.random() * 0.015);
          const currentScale = parseFloat(particle.style.transform.replace(/[^0-9.]/g, '')) || 1;
          particle.style.transform = `translate(-50%, -50%) scale(${currentScale * 0.96})`;

          if (particle.style.opacity > 0) {
            requestAnimationFrame(animate);
          } else {
            particle.remove();
          }
        })();
      }
    }

    let fireworkIntervals = [];

    function clearAllFireworkIntervals() {
      fireworkIntervals.forEach(clearInterval);
      fireworkIntervals = [];
    }

    function startFireworkForElement(element) {
      if (!document.hidden) {
        const intervalId = setInterval(() => {
          if (!document.hidden && element.closest('.destaque-hoje')) {
            spawnFirework(element);
          }
        }, 800 + Math.random() * 500); 
        fireworkIntervals.push(intervalId);
      }
    }

    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        clearAllFireworkIntervals();
      } else {
        document.querySelectorAll('.destaque-hoje .twinkle-lights').forEach(tw => {
          startFireworkForElement(tw);
        });
      }
    });

    // --- 3. MENU/FOOTER ---
    ['menu','footer'].forEach(file => {
      fetch(`${file}.html?t=${Date.now()}`)
        .then(r => r.text())
        .then(html => {
          const placeholder = document.getElementById(`${file}-placeholder`);
          if (placeholder) placeholder.innerHTML = html;
          if (file === 'menu') {
            const toggle = document.getElementById('menu-toggle');
            const menuEl = document.getElementById('menu');
            if (toggle && menuEl) {
              toggle.addEventListener('click', () => {
                menuEl.classList.toggle('active');
              });
            }
          }
        }).catch(e => console.error(`Error loading ${file}.html:`, e));
    });

    // --- 4. DATA ---
    const hoje = new Date();
    const dia = hoje.getDate();
    const mes = hoje.getMonth();
    const ano = hoje.getFullYear();
    const meses = ['janeiro','fevereiro','mar√ßo','abril','maio','junho','julho','agosto','setembro','outubro','novembro','dezembro'];
    const hojePt = `${dia} de ${meses[mes]} de ${ano}`;
    const dataHojeEl = document.getElementById('data-hoje-novidades');
    if (dataHojeEl) dataHojeEl.textContent = hojePt;

    // --- 5. FETCH GEN√âRICO ---
    async function fetchData(path) {
      const cacheBuster = Date.now();
      try {
        const res = await fetch(`${path}?t=${cacheBuster}`);
        if (!res.ok) throw new Error(`HTTP error ${res.status} for ${path}`);
        return await res.json();
      } catch(e) {
        console.error(`Failed to fetch ${path}:`, e);
        return null;
      }
    }
    
    // --- 6. RENDERIZADORES ---
    
    // Novidades
    async function renderNovidades() {
      const data = await fetchData('novidades.json');
      const c = document.getElementById('novidades-container');
      if (!c) return;
      if (!data) {
        c.innerHTML = '<p>Erro ao carregar novidades.</p>';
        return;
      }
      c.innerHTML = '';
      data.forEach(n => {
        c.innerHTML += `
          <div class="novidade-card">
            <div class="novidade-img"><i class="${n.icone}"></i></div>
            <div class="novidade-content">
              <h3>${n.titulo}</h3>
              <div class="novidade-date"><i class="far fa-calendar-alt"></i> ${n.data}</div>
              <p>${n.conteudo||n.resumo||''}</p>
            </div>
          </div>`;
      });
    }

    // Reflex√£o
    async function renderReflexao() {
      const data = await fetchData('reflexaododia.json');
      const c = document.getElementById('reflexao-container');
      if (!c) return;
      if (!data) {
        c.innerHTML = '<p>Erro ao carregar reflex√£o.</p>';
        return;
      }
      const key = `${String(dia).padStart(2,'0')}/${String(mes+1).padStart(2,'0')}/${ano}`;
      const r = data.find(x => x.data === key);
      c.innerHTML = '';
      if (!r) {
        c.innerHTML = '<p>Sem reflex√£o para hoje.</p>';
        return;
      }
      const card = document.createElement('div');
      card.className = 'reflexao-card';
      
      card.innerHTML = `
        <p class="reflexao-frase">"${r.frase}"</p>
        <p class="reflexao-autor">- ${r.autor}</p>
        <button class="reflexao-instrucao">Clique aqui para refletir</button>
        <div class="reflexao-extra">
          <p class="reflexao-texto">${r.reflexao}</p>
          <p class="reflexao-data">Reflex√£o: ${r.data}</p>
        </div>`;
        
      const extra = card.querySelector('.reflexao-extra');
      const instr = card.querySelector('.reflexao-instrucao');
      
      if (extra) extra.style.display = 'none';
      if (instr) {
        instr.addEventListener('click', () => {
          if (extra) extra.style.display = extra.style.display === 'none' ? 'block' : 'none';
        });
      }
      c.appendChild(card);
    }

    // Aniversariantes
    async function renderAniversariantes() {
      const data = await fetchData('aniversariantes.json');
      const container = document.getElementById('aniversariantes-container');
      if (!container) return;
      if (!data) {
        container.innerHTML = '<p>Erro ao carregar aniversariantes.</p>';
        return;
      }
      container.innerHTML = '';
      clearAllFireworkIntervals();

      const hojeAtual = new Date();
      const diaHoje = String(hojeAtual.getDate()).padStart(2,'0');
      const mesHoje = String(hojeAtual.getMonth()+1).padStart(2,'0');
      const nomesMes = ['janeiro','fevereiro','mar√ßo','abril','maio','junho','julho','agosto','setembro','outubro','novembro','dezembro'];

      data.forEach(a => {
        const [dStr,mStr] = a.data ? a.data.split('/') : ['',''];
        const card = document.createElement('div');
        card.className = 'aniversariante-card';

        if (dStr === diaHoje && mStr === mesHoje) {
          card.classList.add('destaque-hoje');
          const tw = document.createElement('div');
          tw.className = 'twinkle-lights';
          card.appendChild(tw);
          startFireworkForElement(tw);
        }

        const dataFmt = (dStr && mStr && nomesMes[Number(mStr)-1]) ? `${dStr} de ${nomesMes[Number(mStr)-1]}` : 'Data inv√°lida';
        
        const imgContainer = document.createElement('div');
        imgContainer.className = 'aniversariante-img';
        
        if (a.imagem) {
          const img = document.createElement('img');
          img.alt = a.nome || 'Aniversariante';
          img.onerror = function() {
            if (a.imagem_fallback) {
              this.onerror = function() { imgContainer.innerHTML = '<i class="fas fa-birthday-cake"></i>'; };
              this.src = a.imagem_fallback;
            } else {
              imgContainer.innerHTML = '<i class="fas fa-birthday-cake"></i>';
            }
          };
          img.src = a.imagem;
          imgContainer.appendChild(img);
        } else {
          imgContainer.innerHTML = '<i class="fas fa-birthday-cake"></i>';
        }
        card.appendChild(imgContainer);
        
        const infoDiv = document.createElement('div');
        infoDiv.className = 'aniversariante-info';
        infoDiv.innerHTML = `
          <h3><i class="fas fa-birthday-cake"></i> ${a.nome || 'Aniversariante'}</h3>
          ${a.cargo ? `<p>${a.cargo}</p>` : ''}
          <p class="aniversariante-data">${dataFmt}</p>
        `;
        card.appendChild(infoDiv);
        container.appendChild(card);
      });
    }

    // F√©rias
    async function renderFerias() {
       const data = await fetchData("ferias.json");
       const grid = document.getElementById("ferias-grid-container");
       const tb   = document.getElementById("ferias-tbody");
       if (!grid || !tb) return;

       const hoje = new Date();
       hoje.setHours(0, 0, 0, 0);

       function isSameDate(dateStr, comparisonDate) {
         try {
           const [dia, mes, ano] = dateStr.split("/");
           if (!dia || !mes || !ano || isNaN(Number(dia)) || isNaN(Number(mes)) || isNaN(Number(ano))) return false;
           const dataObj = new Date(Number(ano), Number(mes) - 1, Number(dia));
           dataObj.setHours(0, 0, 0, 0);
           return dataObj.getTime() === comparisonDate.getTime();
         } catch (e) {
           return false;
         }
       }

       const dataFiltrada = (data || []).filter(f => {
          try {
             const [dia, mes, ano] = f.retorno.split("/");
             if (!dia || !mes || !ano || isNaN(Number(dia)) || isNaN(Number(mes)) || isNaN(Number(ano))) return false;
             const dataRetorno = new Date(Number(ano), Number(mes) - 1, Number(dia));
             dataRetorno.setHours(0, 0, 0, 0);
             return dataRetorno >= hoje;
          } catch (e) { return false; }
       });

       grid.innerHTML = "";
       tb.innerHTML   = "";

       if (data === null) {
         const errorMsg = "<p>Erro ao carregar f√©rias.</p>";
         grid.innerHTML = errorMsg;
         tb.innerHTML = `<tr><td colspan="4">${errorMsg}</td></tr>`;
         return;
       }

       if (dataFiltrada.length === 0) {
         const noDataMsg = "<p>Nenhum colaborador em f√©rias retornando hoje ou futuramente.</p>";
         grid.innerHTML = noDataMsg;
         tb.innerHTML = `<tr><td colspan="4">Nenhum colaborador em f√©rias retornando hoje ou futuramente.</td></tr>`;
         return;
       }

       dataFiltrada.forEach(f => {
         const retornaHoje = isSameDate(f.retorno, hoje);
         const cardDiv = document.createElement("div");
         cardDiv.className = "ferias-card";
         if (retornaHoje) cardDiv.classList.add("retorno-hoje-piscar");
         
         cardDiv.innerHTML = `
           <div class="ferias-card-header">
             <i class="fas fa-plane-departure ferias-card-icon"></i>
             <span class="ferias-card-colaborador">${f.colaborador}</span>
           </div>
           <div class="ferias-dates">
             <span class="ferias-card-inicio">In√≠cio: ${f.inicio}</span>
             <span class="ferias-card-retorno">Retorno: ${f.retorno}</span>
           </div>
           <p class="ferias-card-departamento">${f.departamento}</p>
         `;
         grid.appendChild(cardDiv);

         const tr = document.createElement("tr");
         if (retornaHoje) tr.classList.add("retorno-hoje-piscar");
         tr.innerHTML = `
           <td>${f.colaborador}</td>
           <td>${f.departamento}</td>
           <td>${f.inicio}</td>
           <td>${f.retorno}</td>`;
         tb.appendChild(tr);
       });
     }

    // CIPA
    async function renderCIPA() {
      const raw = await fetchData('cipa.json');
      const c = document.getElementById('cipa-container');
      if (!c) return;
      if (!raw) {
        c.innerHTML = '<p>Erro ao carregar CIPA.</p>';
        return;
      }
      c.innerHTML = '';
      const list = Array.isArray(raw) ? raw : (typeof raw === 'object' && raw !== null ? Object.values(raw) : []);
      if (list.length === 0) {
        c.innerHTML = '<p>Nenhuma informa√ß√£o da CIPA dispon√≠vel.</p>';
        return;
      }
      list.forEach(i => {
        c.innerHTML += `
          <div class="cipa-card">
            <div class="cipa-icon"><i class="${i.icone || 'fas fa-shield-alt'}"></i></div>
            <h3>${i.titulo||i.nome||'Item CIPA'}</h3>
            <p>${i.conteudo||i.cargo_cipa||''}</p>
          </div>`;
      });
    }

    renderNovidades();
    renderReflexao();
    renderAniversariantes();
    renderFerias();
    renderCIPA();
  });
  </script>

  <script>
const nomesFemininos = [
    'abigail', 'abriele', 'adriane', 'agnes', 'aitana', 'alana', 'alba', 'alessia',  
    'alexia', 'aliceia', 'alzira', 'amalia', 'ana paula', 'anais', 'angelica', 'angelina',  
    'antonia', 'anita', 'antonieta', 'ara', 'ariana', 'ariane', 'arlete', 'arlene',  
    'arminda', 'audrey', 'aurora', 'ayla', 'azilda', 'barbara', 'beatrice', 'bellamy',  
    'benedita', 'bernadete', 'bertina', 'bertha', 'betsy', 'biana', 'blendina', 'blenda',  
    'branda', 'brigitte', 'camille', 'candida', 'carmela', 'carminha', 'caroline', 'catarina',  
    'cec√≠lia', 'celia', 'celina', 'chantal', 'charlene', 'charlotte', 'christiane', 'cielete',  
    'cilene', 'clarice', 'claudete', 'claudiana', 'claudine', 'claudionora', 'clelia', 'cleusa',  
    'clotilde', 'clementina', 'cordelia', 'corina', 'cristal', 'cristela', 'crislaine', 'dad√°',  
    'dagmar', 'dalila', 'dalva', 'damiana', 'danila', 'danisa', 'darc√≠lia', 'darlene',  
    'deadina', 'deise', 'dela', 'delia', 'demetria', 'denise', 'derci', 'desir√©e',  
    'diana', 'dilma', 'dinorah', 'dion√≠sia', 'dirce', 'divina', 'dominica', 'domingas',  
    'doroteia', 'edi', 'edilene', 'edite', 'elaine', 'elba', 'elderina', 'eleonora',  
    'elfrida', 'elisabete', 'elis√¢ngela', 'eliza', 'elizabete', 'elma', 'elvira', 'ema',  
    'em√≠lia', 'ena', 'enede', 'ereia', 'erika', 'erise', 'erteca', 'erta',  
    'esmeralda', 'estela', 'estrela', 'eudoxia', 'eul√°lia', 'eunice', 'eva', 'evangelina',  
    'everl√∫cia', 'exilda', 'fabiana', 'f√°tima', 'felicidade', 'fermina', 'fiama', 'flora',  
    'florinda', 'fortuna', 'francine', 'francisca', 'frida', 'gabrielle', 'gasparina', 'genevi√®ve',  
    'genilda', 'geovana', 'geovana', 'geovana', 'gilda', 'gina', 'ginger', 'gislaine',  
    'gleice', 'glenda', 'gl√≥ria', 'goretti', 'graciete', 'gracilene', 'guida', 'haid√©e',  
    'halina', 'hanae', 'hana', 'hanna', 'helle', 'helma', 'henriqueta', 'herminia',  
    'heveline', 'hilaria', 'hilda', 'hom√©rica', 'hylda', 'ida', 'ileana', 'ilma',  
    'ilza', 'imelda', 'in√™s', 'iraci', 'irene', 'irislene', 'irlanda', 'ismaela',  
    'itagl√™cia', 'ivanete', 'ivone', 'ivoneide', 'ivonilde', 'izabel', 'izabela', 'izildinha',  
    'jada', 'janete', 'janina', 'janine', 'jaqueline', 'jelena', 'jemima', 'jessiane',  
    'joana d‚Äôarc', 'jocasta', 'joelia', 'joenilda', 'jole', 'jonas', 'jorgeana', 'joselina',  
    'josiana', 'jovita', 'joyce', 'julia', 'junia', 'justina', 'karine', 'karla',  
    'karol', 'katia', 'k√°tia', 'kely', 'keyla', 'kimberly', 'kissia', 'kristina',  
    'laraine', 'larissa', 'lau', 'lauraine', 'lea', 'lebina', 'leila', 'leina',  
    'lemara', 'lendite', 'leonor', 'lepida', 'lesbia', 'let√≠cia', 'levina', 'liana',  
    'lidia', 'lidiane', 'liliane', 'lilisa', 'lilja', 'linda', 'linet', 'lion√™',  
    'liora', 'lisandra', 'lissa', 'lita', 'lizabeth', 'lorena', 'lorene', 'lority',  
    'lourdes', 'lucia', 'lucinda', 'ludmila', 'luene', 'luise', 'luiza', 'lumena',  
    'luzia', 'lygia', 'lys', 'madalena', 'mafalda', 'maisa', 'malu', 'marcela',  
    'marcelina', 'marcilene', 'marcia', 'marcosina', 'margarida', 'marina', 'maristela', 'marli',  
    'marlene', 'marlise', 'marlita', 'marly', 'maroma', 'marquita', 'marry', 'matilde',  
    'maureen', 'mayana', 'mayumi', 'melina', 'melissa', 'melodia', 'mercedes', 'mirela',  
    'mirian', 'mirna', 'm√¥nica', 'monserrath', 'muriel', 'nadja', 'nadine', 'naide',  
    'nalva', 'nara', 'natacha', 'nathalie', 'nereide', 'nery', 'nicete', 'nicola',  
    'nina', 'noemi', 'norma', 'odonira', 'of√©lia', 'olaia', 'olga', 'olinda',  
    'omara', 'ondina', 'onesina', 'oreliana', 'oriana', 'orlanda', 'orlene', 'osana',  
    '√≥thila', 'pac√≠fica', 'paloma', 'pandora', 'paneia', 'paola', 'parecida', 'parisa',  
    'patr√≠cia', 'paulaine', 'paulina', 'pen√©lope', 'perp√©tua', 'petra', 'pia', 'piedade',  
    'pigmeia', 'poliana', 'polyana', 'prisca', 'profir√≠a', 'queli', 'quenia', 'quirina',  
    'racquel', 'rafaella', 'raiane', 'raina', 'ralphina', 'ramira', 'rebecca', 'regiane',  
    'regina', 'rehia', 'relita', 'remosina', 'renata', 'renata', 'renilda', 'renilde',  
    'renite', 'reola', 'reteme', 'reuza', 'rica', 'ricarda', 'r√≠gia', 'rinata',  
    'rita', 'robina', 'robyn', 'rocela', 'rochelle', 'rodesia', 'rodolina', 'rog√©ria',  
    'rosa', 'rosalba', 'rosalina', 'rosamaria', 'ros√¢ngela', 'roseni', 'rosifer', 'rosilene',  
    'rosimeire', 'rosine', 'rosita', 'roxana', 'ruth', 'sabina', 'sabrina', 'salete',  
    'samanta', 'samira', 'sandra', 'sandy', 'sania', 'sanira', 'sanita', 'saraly',  
    'sara', 'savina', 'seice', 'selia', 'selva', 'senda', 'serafina', 'serena',  
    'sheron', 'shirley', 'sidneia', 's√≠lvia', 'simara', 'simona', 'sintia', 'siomara',  
    'sirlene', 's√¥nia', 'sonia', 'soraia', 'soraya', 'sueli', 's√∫ellen', 'suely',  
    'susana', 'susanne', 'sweetie', 'talitha', 'tamara', 't√¢mara', 'tamilia', 'tanice',  
    'tarcila', 'tatiane', 'tchabi', 'tecla', 'teodora', 'teresinha', 'theresa', 'th√≠cia',  
    'thiffany', 'thina', 'thomazina', 'tim√≥teo', 'tina', 'tresa', 'troiana', 't√∫lia',  
    'ulrica', 'unice', 'ur√¢nia', 'vanessa', 'v√¢nia', 'vania', 'vanda', 'vang√©lia',  
    'vanice', 'vanusa', 'vanuza', 'v√¢nia', 'venice', 'venucia', 'verena', 'ver√¥nica',  
    'viana', 'victoria', 'vict√≥ria', 'violeta', 'virginia', 'vislane', 'viviane', 'viviana',  
    'wanda', 'welma', 'luciene', 'anielle', 'yasmin', 'yana', 'yara', 'yasmin',  
    'yone', 'yvana', 'yvone', 'yvone', 'za√≠ra', 'zanira', 'zelia', 'zelia',  
    'zelma', 'z√©lia', 'ziralda', 'zirene', 'iasmim', 'daniele', 'solanie Paz', 'tayane', 'solanie', 'milene', 'zoe'
];

function removeAcentos(str) {
  return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
}

function determinarGenero(nome) {
  if (!nome) return 'masculino';
  let primeiroNome = nome.split(" ")[0].toLowerCase();
  primeiroNome = removeAcentos(primeiroNome);
  if (primeiroNome.endsWith('a') && primeiroNome !== 'joshua' && primeiroNome !== 'luca') {
    return 'feminino';
  }
  if (nomesFemininos.includes(primeiroNome)) {
    return 'feminino';
  }
  return 'masculino';
}

async function carregaJSON(arquivo) {
  try {
    return await fetch(arquivo + '?t=' + Date.now()).then(r => r.json());
  } catch (e) {
    return null;
  }
}

function juntarNomes(nomes) {
  if (nomes.length === 1) return nomes[0];
  if (nomes.length === 2) return nomes[0] + ' e ' + nomes[1];
  return nomes.slice(0, -1).join(', ') + ' e ' + nomes[nomes.length - 1];
}

function getPluralGenero(generos) {
  const femininoCount = generos.filter(g => g === "feminino").length;
  if (femininoCount === generos.length) return {pronome: "elas", verboVoltar: "voltam", verboAniv: "fazem"};
  if (femininoCount === 0) return {pronome: "eles", verboVoltar: "voltam", verboAniv: "fazem"};
  return {pronome: "eles", verboVoltar: "voltam", verboAniv: "fazem"};
}

document.addEventListener('DOMContentLoaded', async () => {
  const hoje = new Date();
  const dia = String(hoje.getDate()).padStart(2, '0');
  const mes = String(hoje.getMonth() + 1).padStart(2, '0');
  const ano = hoje.getFullYear();
  const dataAtualStr = `${dia}/${mes}`;
  const dataCompleta = `${dia}/${mes}/${ano}`;
  let mensagens = [];

  function getArtigoSingular(genero) {
    return genero === 'feminino' ? 'da' : 'do';
  }

  function getArtigoPlural(generos) {
    const todasFeminino = generos.every(g => g === 'feminino');
    return todasFeminino ? 'da' : 'das';
  }

  const aniversariantes = await carregaJSON('aniversariantes.json');
  const nomesAniv = [];
  const generosAniv = [];

  if (Array.isArray(aniversariantes)) {
    aniversariantes.forEach(({ nome, data }) => {
      if (data === dataAtualStr) {
        nomesAniv.push(nome);
        generosAniv.push(determinarGenero(nome));
      }
    });

    if (nomesAniv.length === 1) {
      const genero = generosAniv[0];
      const pronome = genero === 'feminino' ? 'ela' : 'ele';
      const artigo = getArtigoSingular(genero);
      mensagens.push(
        `ü•≥ Hoje √© anivers√°rio ${artigo} ${nomesAniv[0]}, d√™ os parab√©ns para ${pronome}!`
      );
    }
    else if (nomesAniv.length > 1) {
      const nomesStr = juntarNomes(nomesAniv);
      const pronome = generosAniv.every(g => g === 'feminino')
        ? 'elas'
        : 'eles';
      mensagens.push(
        `ü•≥ Hoje, ${nomesStr} fazem anivers√°rio. D√™ os parab√©ns a ${pronome}!`
      );
    }
  }

  const ferias = await carregaJSON('ferias.json');
  let nomesFerias = [];
  let generosFerias = [];
  if (ferias && Array.isArray(ferias)) {
    ferias.forEach(f => {
      if (f.retorno === dataCompleta) {
        nomesFerias.push(f.colaborador);
        generosFerias.push(determinarGenero(f.colaborador));
      }
    });
    if (nomesFerias.length === 1) {
      const pronome = generosFerias[0] === "feminino" ? "ela" : "ele";
      mensagens.push(`‚úàÔ∏è Hoje, ${nomesFerias[0]} retorna de f√©rias. D√™ as boas-vindas a ${pronome}!`);
    } else if (nomesFerias.length > 1) {
      const nomesStr = juntarNomes(nomesFerias);
      const plural = getPluralGenero(generosFerias);
      mensagens.push(`‚úàÔ∏è Hoje, ${nomesStr} retornam de f√©rias. D√™ as boas-vindas a ${plural.pronome}!`);
    }
  }

  const feriados = await carregaJSON('feriados.json');
  if (feriados && Array.isArray(feriados)) {
    feriados.forEach(f => {
      if (f.data === dataAtualStr) {
        mensagens.push(`üìÖ Hoje √© ${f.nome}. Bom feriado!`);
      }
    });
  }

  let mensagemFinal = mensagens.length ? mensagens.join("<br>") : "Aqui √© o seu espa√ßo. Aqui √© PSR!";
  const bannerP = document.querySelector('.banner > p');
  if (bannerP) bannerP.innerHTML = mensagemFinal;
});
  </script>
</body>
</html>
