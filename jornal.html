<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" href="favicon.png" type="image/png">
  <meta property="og:title" content="Portal PSR">
  <meta property="og:description" content="Jornal PSR">
  <meta property="og:image" content="https://i.postimg.cc/y602YBCK/0-CAPA.jpg">
  <meta property="og:url" content="https://psrindustria.github.io/PortalPSR/">
  <meta property="og:type" content="website">
  <title>PSR Indústria - Jornal PSR</title>
  <!-- CSS principal -->
  <link rel="stylesheet" href="style.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    /* reset básico */
    html, body { margin: 0; padding: 0; height: 100%; background: #e0e0e0; font-family: sans-serif; }
    main {
      margin-top: 50px;
      margin-bottom: 0;
      padding-bottom: 0;
      text-align: center;
      position: relative;
      padding-top: 30px;
      /* Ajuste de altura para garantir que caiba na tela */
      min-height: calc(100vh - 150px); 
    }

    /* Controles flutuantes para modo nativo */
    .viewer-controls {
      position: fixed;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding: 15px;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      z-index: 1000;
      transition: all 0.3s ease;
      opacity: 0.6;
      scale: 0.85;
    }
    .viewer-controls:hover { opacity: 1; scale: 1; background: rgba(0, 0, 0, 0.85); }

    /* Controles para modo revista (centralizados no topo) */
    .viewer-controls.book-mode-controls {
      position: fixed;
      top: 80px; /* Abaixo do menu */
      left: 50%;
      right: auto;
      transform: translateX(-50%);
      flex-direction: row;
      gap: 15px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      opacity: 0.9;
      scale: 1;
      border: 1px solid #ccc;
    }
    .viewer-controls.book-mode-controls:hover { background: rgba(255, 255, 255, 0.98); opacity: 1; }

    .control-btn {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      border: none;
      padding: 8px 10px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .control-btn:hover { background: rgba(255, 255, 255, 1); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
    .control-btn:disabled { background: rgba(255, 255, 255, 0.5); color: #999; cursor: not-allowed; transform: none; }

    /* Controles no modo revista */
    .book-mode-controls .control-btn { background: #333; color: #fff; padding: 10px 15px; font-size: 16px; }
    .book-mode-controls .control-btn:hover { background: #555; }
    .book-mode-controls .control-btn:disabled { background: #ccc; color: #999; }

    .mode-toggle { background: #007bff !important; color: #fff !important; font-size: 12px; padding: 6px 10px; }
    .book-mode-controls .mode-toggle { background: #007bff !important; font-size: 14px; padding: 8px 12px; }

    .zoom-controls { display: flex; flex-direction: column; gap: 5px; }
    .book-mode-controls .zoom-controls { flex-direction: row; gap: 5px; }

    .page-counter {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      padding: 6px 10px;
      border-radius: 8px;
      font-weight: bold;
      font-size: 12px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(5px);
    }
    .book-mode-controls .page-counter { background: #f8f9fa; padding: 8px 12px; font-size: 14px; border: 1px solid #ddd; }

    /* Container do visualizador */
    .journal-container {
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      position: relative;
      transition: all 0.5s ease;
    }

    /* MODO NATIVO (Mantido Original) */
    .native-mode { display: block; padding-bottom: 50px; }
    .native-mode .page-image {
      width: 100%;
      height: auto;
      display: block;
      margin-bottom: 10px;
      transition: transform 0.3s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }

    /* --- MODO REVISTA (Novo e Corrigido) --- */
    .book-mode {
      display: none;
      position: relative;
      height: 80vh; /* Altura fixa para caber na tela */
      width: 100%;
      /* Centralização */
      align-items: center;
      justify-content: center;
      perspective: 2500px; /* Profundidade 3D */
      overflow: hidden; /* Evita scrollbar indesejado */
    }

    /* Container das páginas */
    .book-spread {
      position: relative;
      width: 90vw;
      max-width: 1100px; /* Tamanho máximo aberto */
      aspect-ratio: 1.5 / 1; /* Formato paisagem (duas páginas A4) */
      transform-style: preserve-3d;
      transition: transform 0.3s ease;
      /* Sombra para destacar do fundo */
      box-shadow: 0 20px 50px rgba(0,0,0,0.4); 
    }

    /* Página individual */
    .book-page {
      position: absolute;
      width: 50%;
      height: 100%;
      top: 0;
      background: #fdfdfd;
      overflow: hidden;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      /* Transição mais complexa para simular física do papel */
      transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                  border-radius 0.4s ease,
                  box-shadow 0.4s ease;
    }

    /* Imagem dentro da página */
    .book-page img {
      width: 100%;
      height: 100%;
      object-fit: fill; /* Preenche toda a área */
      user-select: none;
      pointer-events: none;
    }

    /* Configuração Esquerda */
    .book-page.left-page {
      left: 0;
      transform-origin: right center; /* Gira na lombada */
      border-radius: 4px 0 0 4px;
      z-index: 1;
    }
    /* Sombra da lombada (esquerda) */
    .book-page.left-page::after {
      content: ""; position: absolute; top:0; right:0; bottom:0; width: 40px;
      background: linear-gradient(to left, rgba(0,0,0,0.15), transparent);
      pointer-events: none;
    }

    /* Configuração Direita */
    .book-page.right-page {
      right: 0;
      transform-origin: left center; /* Gira na lombada */
      border-radius: 0 4px 4px 0;
      z-index: 1;
    }
    /* Sombra da lombada (direita) */
    .book-page.right-page::after {
      content: ""; position: absolute; top:0; left:0; bottom:0; width: 40px;
      background: linear-gradient(to right, rgba(0,0,0,0.15), transparent);
      pointer-events: none;
    }

    /* --- ANIMAÇÕES DE VIRADA COM EFEITO CURVADO --- */
    
    /* Virando da Direita para Esquerda (Avançar) */
    .turn-to-left {
      transform: rotateY(-180deg);
      z-index: 20;
    }
    
    /* Virando da Esquerda para Direita (Voltar) */
    .turn-to-right {
      transform: rotateY(180deg);
      z-index: 20;
    }

    /* Efeito de curvatura (Levanta a ponta inferior) */
    .bending-page-right {
      border-bottom-right-radius: 120px !important;
      border-top-right-radius: 10px !important;
      box-shadow: 15px 15px 30px rgba(0,0,0,0.25);
    }
    
    .bending-page-left {
      border-bottom-left-radius: 120px !important;
      border-top-left-radius: 10px !important;
      box-shadow: -15px 15px 30px rgba(0,0,0,0.25);
    }

    /* Estados auxiliares */
    .start-turned-left { transform: rotateY(-180deg); }
    .start-turned-right { transform: rotateY(180deg); }
    .notransition { transition: none !important; }

    /* Zoom / pan UX */
    .zoomed { cursor: grab; transform-origin: top left; position: absolute; pointer-events: auto !important; z-index: 50; }
    .zoomed:active { cursor: grabbing; }

    /* Mobile responsivo */
    @media (max-width: 768px) {
      .viewer-controls { display: none; }
      .journal-container { max-width: 100%; padding: 0 10px; }
      .book-mode { display: none !important; }
      .native-mode { display: block !important; }
      .native-mode .page-image { margin-bottom: 5px; }
    }

    /* Estilos básicos para o menu mobile (caso o menu.html dependa disso) */
    .menu-mobile { display: none; }
    @media (max-width: 768px) {
      .menu-mobile { display: block; }
      .menu-toggle { cursor: pointer; padding: 10px; position: absolute; top: 15px; right: 15px; z-index: 1000; }
    }

    /* Fundo decorativo para modo revista */
    .book-mode::before {
      content: ''; position: absolute; inset: 0;
      background: radial-gradient(circle, #e0e0e0 0%, #c0c0c0 100%);
      z-index: -1;
    }
  </style>
</head>
<body>
  <!-- MENU dinâmico (Mantido original) -->
  <div id="menu-placeholder"></div>

  <!-- Conteúdo principal: Visualizador de Jornal -->
  <main>
    <!-- Controles flutuantes -->
    <div class="viewer-controls" id="viewerControls">
      <button class="control-btn" id="prevBtn" onclick="previousPage()" title="Página Anterior">
        <i class="fas fa-chevron-left"></i>
      </button>

      <div class="page-counter">
        <span id="currentPageNum">1</span>/<span id="totalPages">17</span>
      </div>

      <button class="control-btn" id="nextBtn" onclick="nextPage()" title="Próxima Página">
        <i class="fas fa-chevron-right"></i>
      </button>

      <div class="zoom-controls">
        <button class="control-btn" onclick="zoomOut()" title="Diminuir Zoom"><i class="fas fa-search-minus"></i></button>
        <button class="control-btn" onclick="zoomIn()"  title="Aumentar Zoom"><i class="fas fa-search-plus"></i></button>
        <button class="control-btn" onclick="resetZoom()" title="Resetar Zoom"><i class="fas fa-expand"></i></button>
      </div>

      <button class="control-btn mode-toggle" id="modeToggle" onclick="toggleMode()" title="Alternar Modo">
        Revista
      </button>
    </div>

    <!-- Container do visualizador -->
    <div class="journal-container" id="journalContainer">
      <!-- Modo Nativo (padrão) -->
      <div class="native-mode" id="nativeMode">
        <!-- Imagens geradas via JS -->
      </div>

      <!-- Modo Livro (Estrutura 3D) -->
      <div class="book-mode" id="bookMode">
        <div class="book-spread">
          <div class="book-page left-page" id="leftPage">
            <img src="" alt="Página Esquerda">
          </div>
          <div class="book-page right-page" id="rightPage">
            <img src="" alt="Página Direita">
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER dinâmico (Mantido original) -->
  <div id="footer-placeholder"></div>

  <!-- Scripts -->
  <script>
    // NOVAS IMAGENS (17 páginas)
    const pages = [
      'https://i.postimg.cc/y602YBCK/0-CAPA.jpg',
      'https://i.postimg.cc/pVK3XxMX/01-Sumario.jpg',
      'https://i.postimg.cc/NGRZfYv9/02-Missao-e-Valores.jpg',
      'https://i.postimg.cc/Fsm8YqhK/03-Tema-do-Mes.jpg',
      'https://i.postimg.cc/KctCvFhT/04-Tema-do-Mes.jpg',
      'https://i.postimg.cc/8PD973Tf/05-Vale-a-Leitura.jpg',
      'https://i.postimg.cc/dtvphXJT/06-Series-e-Filmes.jpg',
      'https://i.postimg.cc/15P28Ty6/07-Reflexao.jpg',
      'https://i.postimg.cc/Qxsw-FPj1/08-Reflexao.jpg',
      'https://i.postimg.cc/TYGFKSTJ/09-Reflexao.jpg',
      'https://i.postimg.cc/KvFw1Vmr/10-Bem-Estar.jpg',
      'https://i.postimg.cc/GhrV4NbX/11-Meio-Ambiente.jpg',
      'https://i.postimg.cc/vHMk4jGP/12-Curiosidades.jpg',
      'https://i.postimg.cc/RVR8KR0P/13-Curiosidades.jpg',
      'https://i.postimg.cc/28wJhw59/14-Aniversariantes.jpg',
      'https://i.postimg.cc/L6T7LTsw-/15-Desligamento.jpg',
      'https://i.postimg.cc/X78hd8J6/16-Novos-Clientes.jpg'
    ];

    // Estado global
    let currentPage = 0;
    const totalPages = pages.length;
    let isBookMode = false;
    let zoomLevel = 1;
    let isDragging = false;
    let startX, startY, imgX = 0, imgY = 0;
    let isAnimating = false;
    let dragElement = null;

    document.addEventListener('DOMContentLoaded', () => {
      // Carrega menu e footer (Estrutura Original)
      ['menu', 'footer'].forEach(file => {
        fetch(`${file}.html`)
          .then(r => r.text())
          .then(html => {
            const placeholder = document.getElementById(`${file}-placeholder`);
            if (placeholder) placeholder.innerHTML = html;

            if (file === 'menu') {
              const toggle = document.getElementById('menu-toggle');
              const menuEl = document.getElementById('menu');
              if (toggle && menuEl) {
                toggle.addEventListener('click', () => menuEl.classList.toggle('active'));
                menuEl.querySelectorAll('a').forEach(link => {
                  link.addEventListener('click', () => menuEl.classList.remove('active'));
                });
              }
            }
          })
          .catch(err => console.log(`Erro ao carregar ${file}.html - Verifique se o arquivo existe.`));
      });

      // Popula o modo nativo
      const nativeContainer = document.getElementById('nativeMode');
      pages.forEach((src, index) => {
        const img = document.createElement('img');
        img.src = src;
        img.className = 'page-image';
        img.alt = `Página ${index + 1}`;
        img.loading = 'lazy';
        nativeContainer.appendChild(img);
      });

      updatePageCounter();
      document.getElementById('totalPages').textContent = totalPages;
      // Prepara a primeira imagem do modo revista (invisível por enquanto)
      updateBookImages(0);
    });

    // --- NAVEGAÇÃO ---
    function nextPage() {
      if (isAnimating) return;

      if (isBookMode) {
        if (currentPage < totalPages - 1) { // Permite virar se houver mais páginas
          animateBookTurn('next');
        }
      } else {
        if (currentPage < totalPages - 1) {
          currentPage++;
          scrollToCurrentPage();
          updatePageCounter();
        }
      }
    }

    function previousPage() {
      if (isAnimating) return;

      if (isBookMode) {
        if (currentPage >= 2) {
          animateBookTurn('prev');
        }
      } else {
        if (currentPage > 0) {
          currentPage--;
          scrollToCurrentPage();
          updatePageCounter();
        }
      }
    }

    // --- ANIMAÇÃO REALISTA (Modo Revista) ---
    function animateBookTurn(direction) {
      isAnimating = true;
      const leftPage = document.getElementById('leftPage');
      const rightPage = document.getElementById('rightPage');
      const duration = 800; // Duração da animação CSS

      if (direction === 'next') {
        // 1. Inicia rotação da página direita
        rightPage.classList.add('turn-to-left');
        
        // 2. Aplica o efeito de dobra (curva) na ponta
        setTimeout(() => { rightPage.classList.add('bending-page-right'); }, 50);

        // 3. Na metade da animação (quando a página está "em pé"), troca o conteúdo
        setTimeout(() => {
          currentPage += 2;
          updateBookImages(currentPage);
          updatePageCounter();
          
          // Reset visual instantâneo para preparar a "chegada"
          rightPage.classList.remove('bending-page-right');
          rightPage.classList.remove('turn-to-left');
          rightPage.classList.add('notransition'); // Remove transição para troca instantânea

          // A página esquerda "assume" o movimento final
          leftPage.classList.add('notransition');
          leftPage.classList.add('start-turned-right'); // Começa girada da direita
          void leftPage.offsetWidth; // Força o navegador a recalcular

          // Finaliza o movimento suavemente
          leftPage.classList.remove('notransition');
          leftPage.classList.remove('start-turned-right');
          rightPage.classList.remove('notransition');

        }, duration / 2);

        setTimeout(() => { isAnimating = false; }, duration + 50);

      } else {
        // Lógica inversa (Voltar página)
        leftPage.classList.add('turn-to-left'); // Hack para iniciar o contexto
        leftPage.style.transform = "rotateY(0deg)"; // Garante posição inicial

        requestAnimationFrame(() => {
            leftPage.classList.add('turn-to-right');
            setTimeout(() => { leftPage.classList.add('bending-page-left'); }, 50);
        });

        setTimeout(() => {
          currentPage -= 2;
          updateBookImages(currentPage);
          updatePageCounter();

          leftPage.classList.remove('bending-page-left');
          leftPage.classList.remove('turn-to-right');
          leftPage.classList.add('notransition');

          rightPage.classList.add('notransition');
          rightPage.classList.add('start-turned-left');
          void rightPage.offsetWidth;

          rightPage.classList.remove('notransition');
          rightPage.classList.remove('start-turned-left');
          leftPage.classList.remove('notransition');
        }, duration / 2);

        setTimeout(() => { isAnimating = false; }, duration + 50);
      }
    }

    function updateBookImages(pageIndex) {
      const leftImg = document.querySelector('#leftPage img');
      const rightImg = document.querySelector('#rightPage img');

      // Garante que a página esquerda seja sempre PAR (0, 2, 4...)
      if (pageIndex % 2 !== 0) pageIndex--;

      leftImg.src = pages[pageIndex] || '';
      // Se não houver próxima página (ímpar final), usa um pixel transparente
      rightImg.src = pages[pageIndex + 1] || 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';

      resetZoom();
    }

    function toggleMode() {
      isBookMode = !isBookMode;
      const nativeMode = document.getElementById('nativeMode');
      const bookMode = document.getElementById('bookMode');
      const journalContainer = document.getElementById('journalContainer');
      const controls = document.getElementById('viewerControls');
      const modeToggle = document.getElementById('modeToggle');

      resetZoom();

      if (isBookMode) {
        nativeMode.style.display = 'none';
        bookMode.style.display = 'flex';
        journalContainer.style.maxWidth = '100%'; // Remove limite lateral
        modeToggle.textContent = 'Nativo';
        controls.classList.add('book-mode-controls');
        
        if (currentPage % 2 !== 0) currentPage--;
        updateBookImages(currentPage);
      } else {
        nativeMode.style.display = 'block';
        bookMode.style.display = 'none';
        journalContainer.style.maxWidth = '800px'; // Restaura limite nativo
        modeToggle.textContent = 'Revista';
        controls.classList.remove('book-mode-controls');
        scrollToCurrentPage();
      }
      updatePageCounter();
    }

    // --- UTILITÁRIOS ---
    function scrollToCurrentPage() {
      const images = document.querySelectorAll('#nativeMode .page-image');
      if (images[currentPage]) {
        images[currentPage].scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    function updatePageCounter() {
      document.getElementById('currentPageNum').textContent = currentPage + 1;
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      if (isBookMode) {
        prevBtn.disabled = currentPage < 2;
        nextBtn.disabled = currentPage >= (totalPages % 2 === 0 ? totalPages - 2 : totalPages - 1);
      } else {
        prevBtn.disabled = currentPage === 0;
        nextBtn.disabled = currentPage === totalPages - 1;
      }
    }

    // --- ZOOM ---
    function zoomIn() { if(zoomLevel < 3) { zoomLevel += 0.5; applyZoom(); } }
    function zoomOut() { if(zoomLevel > 1) { zoomLevel -= 0.5; applyZoom(); } }
    function resetZoom() { zoomLevel = 1; imgX = 0; imgY = 0; applyZoom(); }

    function applyZoom() {
      const targets = isBookMode ? document.querySelectorAll('.book-page img') : document.querySelectorAll('.native-mode .page-image');

      targets.forEach(img => {
        if (zoomLevel > 1) {
          img.style.transform = `scale(${zoomLevel}) translate(${imgX}px, ${imgY}px)`;
          img.classList.add('zoomed');
          img.onmousedown = startDrag;
        } else {
          img.style.transform = `scale(1) translate(0px, 0px)`;
          img.classList.remove('zoomed');
          img.onmousedown = null;
          imgX = 0; imgY = 0;
        }
      });
    }

    function startDrag(e) {
      if (zoomLevel <= 1) return;
      e.preventDefault();
      isDragging = true;
      dragElement = e.target;
      startX = e.clientX;
      startY = e.clientY;
      document.addEventListener('mousemove', drag);
      document.addEventListener('mouseup', endDrag);
    }

    function drag(e) {
      if (!isDragging || !dragElement) return;
      e.preventDefault();
      const deltaX = (e.clientX - startX) / zoomLevel;
      const deltaY = (e.clientY - startY) / zoomLevel;
      imgX += deltaX;
      imgY += deltaY;
      dragElement.style.transform = `scale(${zoomLevel}) translate(${imgX}px, ${imgY}px)`;
      startX = e.clientX;
      startY = e.clientY;
    }

    function endDrag() {
      isDragging = false;
      dragElement = null;
      document.removeEventListener('mousemove', drag);
      document.removeEventListener('mouseup', endDrag);
    }

    // Atalhos
    document.addEventListener('keydown', (e) => {
      if (window.innerWidth > 768) {
        if (e.key === 'ArrowRight') nextPage();
        if (e.key === 'ArrowLeft') previousPage();
        if (e.key === 'Escape') resetZoom();
      }
    });
  </script>
</body>
</html>
